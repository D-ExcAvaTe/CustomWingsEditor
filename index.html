<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wing Particle Layout Builder</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      padding: 2rem;
    }
    h1 {
      margin-bottom: 1rem;
    }
    .controls {
      margin-bottom: 1rem;
    }
    .grid {
      display: inline-grid;
      grid-auto-flow: row;
      gap: 2px;
      border: 2px solid #ccc;
      padding: 5px;
      user-select: none;
    }
    .cell {
      width: 22px;
      height: 22px;
      background: white;
      border: 1px solid #ccc;
      text-align: center;
      line-height: 22px;
      font-size: 12px;
      cursor: pointer;
    }
    .cell.active {
      background: #65c6ff;
      color: black;
    }
    textarea {
      width: 100%;
      height: 300px;
      margin-top: 1rem;
      font-family: monospace;
      font-size: 14px;
      padding: 1rem;
    }
  </style>
</head>
<body>

<h1>ü™Ω Wing Particle Layout Generator</h1>

<div class="controls">
  <label>Grid Size (rows x cols):</label>
  <input type="text" id="gridSize" value="10x20">
  <button onclick="initGrid()">Generate Grid</button>
  <button onclick="exportYML()">‚¨áÔ∏è Export particleLayout</button>
</div>

<div id="grid" class="grid"></div>

<textarea id="output" placeholder="Your layout will appear here..."></textarea>

<script>
  let gridData = [];
  let isMouseDown = false;

  function initGrid() {
    const [rows, cols] = document.getElementById("gridSize").value.split("x").map(Number);
    const grid = document.getElementById("grid");
    grid.style.gridTemplateColumns = `repeat(${cols}, 22px)`;
    grid.innerHTML = "";
    gridData = Array.from({ length: rows }, () => Array(cols).fill("-"));

    for (let y = 0; y < rows; y++) {
      for (let x = 0; x < cols; x++) {
        const div = document.createElement("div");
        div.className = "cell";
        div.dataset.x = x;
        div.dataset.y = y;
        div.addEventListener("mousedown", toggleCell);
        div.addEventListener("mouseover", (e) => {
          if (isMouseDown) toggleCell(e);
        });
        grid.appendChild(div);
      }
    }
  }

  function toggleCell(e) {
    const x = parseInt(e.target.dataset.x);
    const y = parseInt(e.target.dataset.y);
    const val = gridData[y][x] === "-" ? "x" : "-";
    gridData[y][x] = val;
    e.target.textContent = val === "x" ? "x" : "";
    e.target.classList.toggle("active", val === "x");
  }

  window.addEventListener("mousedown", () => isMouseDown = true);
  window.addEventListener("mouseup", () => isMouseDown = false);

  function exportYML() {
    let out = "  particleLayout:\n";
    gridData.forEach((row, idx) => {
      const line = row.join(",");
      out += `    ${idx + 1}: "${line}"\n`;
    });
    document.getElementById("output").value = out;
  }

  // Auto init
  initGrid();
</script>

</body>
</html>
