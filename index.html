<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wing Particle Editor</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f4f4f4;
      color: #333;
    }
    h2 { margin-top: 0; }

    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .grid-wrapper {
      flex-grow: 1;
    }

    .grid {
      display: grid;
      gap: 2px;
      background: #ccc;
      user-select: none;
    }

    .cell {
      width: 20px;
      height: 20px;
      background: #fff;
      border: 1px solid #bbb;
      text-align: center;
      line-height: 20px;
      font-size: 12px;
      cursor: pointer;
    }

    .panel {
      min-width: 300px;
      background: white;
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 8px;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    input, select {
      width: 100%;
      margin-top: 5px;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    button {
      margin-top: 15px;
      padding: 10px 15px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background: #45a049;
    }
  </style>
</head>
<body>
  <h2>ðŸ§š Custom Wings Editor</h2>
  <div class="container">
    <div class="panel">
      <label>Width (X)</label>
      <input type="number" id="width" value="20" min="1" />
      <label>Height (Y)</label>
      <input type="number" id="height" value="10" min="1" />
      <label>Symbol (used in grid)</label>
      <input type="text" id="symbol" value="x" maxlength="1" />
      <button onclick="generateGrid()">Generate Grid</button>

      <label>Particle</label>
      <select id="particle">
        <option value="REDSTONE">REDSTONE</option>
        <option value="FLAME">FLAME</option>
        <option value="SOUL">SOUL</option>
        <option value="VILLAGER_HAPPY">VILLAGER_HAPPY</option>
        <option value="CLOUD">CLOUD</option>
        <option value="HEART">HEART</option>
      </select>

      <label>Color (hex, REDSTONE only)</label>
      <input type="text" id="color" value="ff0000" />

      <label>Distance</label>
      <input type="number" id="distance" value="0" step="0.1" />

      <label>Height</label>
      <input type="number" id="heightOffset" value="0" step="0.1" />

      <label>Angle</label>
      <input type="number" id="angle" value="0" step="0.1" />

      <label>Speed</label>
      <input type="number" id="speed" value="0" step="0.1" />

      <button onclick="applySymbolSettings()">Apply Symbol Settings</button>
      <button onclick="downloadYML()">ðŸ“¥ Download wing.yml</button>
    </div>

    <div class="grid-wrapper">
      <div id="grid" class="grid"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
  <script>
    let gridData = [];
    let isMouseDown = false;
    let currentSymbol = 'x';
    const symbolSettings = {};

    function generateGrid() {
      const w = parseInt(document.getElementById('width').value);
      const h = parseInt(document.getElementById('height').value);
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      grid.style.gridTemplateColumns = `repeat(${w}, 20px)`;
      gridData = Array.from({ length: h }, () => Array(w).fill('-'));

      for (let y = 0; y < h; y++) {
        for (let x = 0; x < w; x++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.dataset.x = x;
          cell.dataset.y = y;
          cell.addEventListener('mousedown', (e) => {
            e.preventDefault();
            isMouseDown = true;
            drawCell(cell);
          });
          cell.addEventListener('mouseover', () => {
            if (isMouseDown) drawCell(cell);
          });
          cell.addEventListener('mouseup', () => isMouseDown = false);
          grid.appendChild(cell);
        }
      }
    }

    document.body.addEventListener('mouseup', () => isMouseDown = false);

    function drawCell(cell) {
      const x = parseInt(cell.dataset.x);
      const y = parseInt(cell.dataset.y);
      const symbol = document.getElementById('symbol').value.trim().charAt(0) || 'x';
      cell.textContent = symbol;
      gridData[y][x] = symbol;
    }

    function applySymbolSettings() {
      const sym = document.getElementById('symbol').value.trim().charAt(0) || 'x';
      symbolSettings[sym] = {
        particle: document.getElementById('particle').value,
        color: document.getElementById('color').value,
        distance: parseFloat(document.getElementById('distance').value),
        height: parseFloat(document.getElementById('heightOffset').value),
        angle: parseFloat(document.getElementById('angle').value),
        speed: parseFloat(document.getElementById('speed').value)
      };
      alert(`Settings applied to symbol "${sym}"`);
    }

    function downloadYML() {
      const ymlObj = {
        showWhenMoving: true,
        whitelistedWorlds: ["all"],
        menuItem: {
          hideInMenu: false,
          name: "&5Custom Wing",
          material: "ENDER_EYE",
          slot: 1,
          page: 1,
          loreWhenEquipped: ["&6Wing equipped"],
          loreWhenUnequipped: ["&cWing unequipped"],
          loreWhenNoPermission: ["&cYou don't own this wing"],
          loreWhenCanBuy: ["&eYou can buy this wing"]
        },
        wing: {
          startVertical: -1.5,
          startDistanceToPlayer: 0.1,
          distanceBetweenParticles: 0.1,
          timer: 0.1,
          flapAnimation: false,
          flapSpeed: 1,
          startOffset: 30,
          stopOffset: 70,
          particleLayout: {},
          particles: symbolSettings
        }
      };

      // Build layout
      gridData.forEach((row, index) => {
        ymlObj.wing.particleLayout[index + 1] = row.join(',');
      });

      const ymlText = jsyaml.dump(ymlObj, { lineWidth: -1 });
      const blob = new Blob([ymlText], { type: 'text/yaml' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'wing.yml';
      a.click();
      URL.revokeObjectURL(url);
    }

    window.onload = generateGrid;
  </script>
</body>
</html>
